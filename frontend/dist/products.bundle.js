(()=>{var n=JSON.parse(localStorage.getItem("wishlist"))||[];function v(t,e){console.log(t),console.log("removing..."),n=n.filter(i=>i.id!==t),localStorage.setItem("wishlist",JSON.stringify(n)),console.log(n),e&&(e.classList.remove("fas"),e.classList.add("far"))}function l(t){return n.some(e=>e.id===t)}function m(t,e){e.addEventListener("click",i=>{i.stopPropagation(),n=JSON.parse(localStorage.getItem("wishlist"))||[];let a=l(t.id),s=e.querySelector(".heartIcon");console.log(s),a?v(t.id,s):(n=[...n,{id:t.id,image:t.image,name:t.name,price:t.price}],localStorage.setItem("wishlist",JSON.stringify(n)),s.classList.remove("far"),s.classList.add("fas"))})}var g={API_BASE_URL:"http://localhost:5050"};async function u(t){try{let e=await fetch(`${g.API_BASE_URL}/products/${t}`);if(!e.ok)throw new Error(`${e.status} - ${e.message}`);let i=await e.json();return i=i.map(a=>{let{_id:s,...o}=a;return a={id:s,...o}}),i}catch(e){console.log(e)}}function p(t,e){e.innerHTML=`<p>${t}</p>`,e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},5e3)}var r=JSON.parse(localStorage.getItem("cart"))||[];function $(t){r.forEach(e=>{e.id===t&&(e.quantity+=1)}),localStorage.setItem("cart",JSON.stringify(r))}var S=t=>r.find(i=>i.id===t.id);function f(t,e,i){e.addEventListener("click",a=>{a.stopPropagation();let s=S(t);if(s)p("Already added in cart! increased item's quantity by 1.",i),$(s.id);else try{r=[...r,{id:t.id,name:t.name,price:t.price,image:t.image,quantity:1}],localStorage.setItem("cart",JSON.stringify(r)),p("Added to cart! You can continue shopping or view cart",i)}catch(o){console.log(o)}})}function w(t,e){let i=document.createElement("div");i.setAttribute("id",t.id),i.innerHTML=`<button id="wishlist${t.id}" class="wishlistBtn allHeart">
  <i class="heartIcon far fa-heart" style="color:#005dc0"></i></button>
  <img class="productListImg" src="./images/serum.webp" alt="${t.name}">
  <h3>${t.name}</h3>
  <p>$${t.price}</p>
  <button class="cartBtn" id="cart${t.id}">Add to cart</button>`,e.append(i)}function I(t,e){let i=document.createElement("article");i.innerHTML=`<div class="productImageContainer"><button class="wishlistBtn singleHeart"><i class="heartIcon far fa-heart" style="color: #0179fd;"></i></button>
  <img class="productListImg" src="./images/serum.webp" alt="${t.name}">
  </div>
  <div class="productDetailContainer">
  <div>
  <h3>${t.name}</h3>
  <p><span>Description:</span> ${t.description.features}</p>
  <p><span>${t.price} Rs</span></p>
  </div>
  <button class="cartBtn singleCartBtn" id="cart${t.id}">Add to cart</button>
  <p>${t.description.deliveryInfo}</p>`,e.append(i)}var h=document.getElementById("productList"),d=document.getElementById("productDetails"),B=new URLSearchParams(window.location.search),L=document.querySelector(".notificationPopup"),y=B.get("class");document.addEventListener("DOMContentLoaded",async()=>{let t=await u(y);await b(t)});var b=async t=>{d.style.display="none",t.forEach(i=>{w(i,h)});let e=h.querySelectorAll("div");for(let i of e){let a=document.getElementById(`wishlist${i.id}`),s=document.getElementById(`cart${i.id}`),o=i.querySelector(".heartIcon"),c=await x(i,t);l(c.id)?(o.classList.remove("far"),o.classList.add("fas")):(o.classList.remove("fas"),o.classList.add("far")),m(c,a),f(c,s,L)}},x=async(t,e)=>{let i=e.find(a=>a.id===t.id);return t.addEventListener("click",a=>{window.history.pushState({},"",`product.html?id=${t.id}`),h.style.display="none",d.style.display="flex",I(i,d);let s=d.querySelector(".heartIcon"),o=document.querySelector(".singleHeart"),c=document.querySelector(".singleCartBtn");m(i,o),f(i,c,L),l(i.id)?(s.classList.remove("far"),s.classList.add("fas")):(s.classList.remove("fas"),s.classList.add("far"))}),i};window.addEventListener("popstate",async()=>{if(window.location.search===`?class=${y}`){let t=await u();b(t),window.history.replaceState({},"",`products.html?class=${y}`),location.reload()}});})();
