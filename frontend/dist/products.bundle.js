(()=>{var n=JSON.parse(localStorage.getItem("wishlist"))||[];function b(t,e){console.log(t),console.log("removing..."),n=n.filter(s=>s.id!==t),localStorage.setItem("wishlist",JSON.stringify(n)),console.log(n),e&&(e.classList.remove("fas"),e.classList.add("far"))}function l(t){return n.some(e=>e.id===t)}function m(t,e){e.addEventListener("click",s=>{s.stopPropagation(),n=JSON.parse(localStorage.getItem("wishlist"))||[];let a=l(t.id),i=e.querySelector(".heartIcon");console.log(i),a?b(t.id,i):(n=[...n,{id:t.id,image:t.image,name:t.name,price:t.price}],localStorage.setItem("wishlist",JSON.stringify(n)),i.classList.remove("far"),i.classList.add("fas"))})}var g={API_BASE_URL:"https://smartcart-ecommerce.vercel.app"};async function u(t){try{let e=await fetch(`${g.API_BASE_URL}/products/${t}`);if(!e.ok)throw new Error(`${e.status} - ${e.message}`);let s=await e.json();return s=s.map(a=>{let{_id:i,...o}=a;return a={id:i,...o}}),s}catch(e){console.log(e)}}function p(t,e){e.innerHTML=`<p>${t}</p>`,e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},5e3)}var r=JSON.parse(localStorage.getItem("cart"))||[];function $(t){r.forEach(e=>{e.id===t&&(e.quantity+=1)}),localStorage.setItem("cart",JSON.stringify(r))}var S=t=>r.find(s=>s.id===t.id);function f(t,e,s){e.addEventListener("click",a=>{a.stopPropagation();let i=S(t);if(i)p("Already added in cart! increased item's quantity by 1.",s),$(i.id);else try{r=[...r,{id:t.id,name:t.name,price:t.price,image:t.image,quantity:1}],localStorage.setItem("cart",JSON.stringify(r)),p("Added to cart! You can continue shopping or view cart",s)}catch(o){console.log(o)}})}function w(t,e){let s=document.createElement("div");s.setAttribute("id",t.id),s.innerHTML=`<button id="wishlist${t.id}" class="wishlistBtn allHeart">
  <i class="heartIcon far fa-heart" style="color:#005dc0"></i></button>
  <img class="productListImg" src="./images/serum.webp" alt="${t.name}">
  <h3>${t.name}</h3>
  <p>$${t.price}</p>
  <button class="cartBtn" id="cart${t.id}">Add to cart</button>`,e.append(s)}function I(t,e){let s=document.createElement("article");s.innerHTML=`<div class="productImageContainer"><button class="wishlistBtn singleHeart"><i class="heartIcon far fa-heart" style="color: #0179fd;"></i></button>
  <img class="productListImg" src="./images/serum.webp" alt="${t.name}">
  </div>
  <div class="productDetailContainer">
  <div>
  <h3>${t.name}</h3>
  <p><span>Description:</span> ${t.description.features}</p>
  <p><span>${t.price} Rs</span></p>
  </div>
  <button class="cartBtn singleCartBtn" id="cart${t.id}">Add to cart</button>
  <p>${t.description.deliveryInfo}</p>`,e.append(s)}var h=document.getElementById("productList"),d=document.getElementById("productDetails"),B=new URLSearchParams(window.location.search),L=document.querySelector(".notificationPopup"),y=B.get("class");document.addEventListener("DOMContentLoaded",async()=>{let t=await u(y);await v(t)});var v=async t=>{d.style.display="none",t.forEach(s=>{w(s,h)});let e=h.querySelectorAll("div");for(let s of e){let a=document.getElementById(`wishlist${s.id}`),i=document.getElementById(`cart${s.id}`),o=s.querySelector(".heartIcon"),c=await x(s,t);l(c.id)?(o.classList.remove("far"),o.classList.add("fas")):(o.classList.remove("fas"),o.classList.add("far")),m(c,a),f(c,i,L)}},x=async(t,e)=>{let s=e.find(a=>a.id===t.id);return t.addEventListener("click",a=>{window.history.pushState({},"",`product.html?id=${t.id}`),h.style.display="none",d.style.display="flex",I(s,d);let i=d.querySelector(".heartIcon"),o=document.querySelector(".singleHeart"),c=document.querySelector(".singleCartBtn");m(s,o),f(s,c,L),l(s.id)?(i.classList.remove("far"),i.classList.add("fas")):(i.classList.remove("fas"),i.classList.add("far"))}),s};window.addEventListener("popstate",async()=>{if(window.location.search===`?class=${y}`){let t=await u();v(t),window.history.replaceState({},"",`products.html?class=${y}`),location.reload()}});})();
